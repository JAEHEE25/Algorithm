# [Lv.2] 주차 요금 계산

### [ 문제 정보 ]
> **프로그래머스**: https://school.programmers.co.kr/learn/courses/30/lessons/92341
> 
> **난이도**: 3
>
> **유형**: #구현


### [ 문제 풀이 ]
```Java
import java.util.*;

class Solution {
    public int[] solution(int[] fees, String[] records) {
        Map<Integer, Car> cars = new HashMap<>(); //차량 번호 map
        
        //records 기반 요금 계산
        for (int i = 0; i < records.length; i++) {
            String[] items = records[i].split(" ");
            String time = items[0];
            int carNum = Integer.parseInt(items[1]);
            String info = items[2];
            
            if (info.equals("IN")) { //입차일 경우
                int inTime = timeToMinutes(time);
                Car car = cars.computeIfAbsent(carNum, k -> new Car(inTime, 0, 0));
                car.in = true;
                car.inTime = inTime;
            } else { //출차일 경우
                Car car = cars.get(carNum);
                int parkTime = timeToMinutes(time) - car.inTime; //누적 주차 시간
                car.parkTime += parkTime;
                car.in = false;
            }
        }
        
        //23:59 계산
        for (int k : cars.keySet()) {
            Car car = cars.get(k);
            if (car.in) { //아직 출차하지 않았다면
                car.parkTime += (timeToMinutes("23:59") - car.inTime);
            }
        }        
    
        //요금 계산
        for (int k : cars.keySet()) {
            Car car = cars.get(k);
            car.fee += fees[1];
            if (car.parkTime > fees[0]) {
                car.fee = calculateFees(car.parkTime, fees);
            }
        }

        //정렬 후 출력
        List<Integer> carNumList = new ArrayList<>(cars.keySet());
        int[] answer = new int[carNumList.size()];
        Collections.sort(carNumList);
        for (int i = 0; i < carNumList.size(); i++) {
            answer[i] = cars.get(carNumList.get(i)).fee;
        }
        
        return answer;
    }
    
    private int calculateFees(int parkTime, int[] fees) {
        int totalFee = 0;
        totalFee += fees[1];
        if (parkTime > fees[0]) { //기본 시간 초과일 경우: 기본 요금 + 단위 시간마다 단위 요금 청구
            totalFee += (Math.ceil((parkTime - fees[0]) / (fees[2] * 1.0)) * fees[3]);
        }
        return totalFee;
    }
    
    private int timeToMinutes(String time) {
        String[] items = time.split(":");
        int h = Integer.parseInt(items[0]);
        int m = Integer.parseInt(items[1]);
        return h * 60 + m;
    }
}

class Car {
    int inTime;
    int parkTime;
    int fee;
    boolean in;
    
    Car(int inTime, int parkTime, int fee) {
        this.inTime = inTime;
        this.parkTime = parkTime;
        this.fee = fee;
        this.in = false;
    }
}

```


---
@www.codrive.co.kr